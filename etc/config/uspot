# uspot Captive Portal Main Configuration
# OpenWRT 23.05+ UCI format
# Based on uspot documentation requirements

# Main captive portal configuration
config uspot 'captive'
	option interface 'captive'
	option setname 'uspot'
	option mode 'click-to-continue'
	option portal_name 'Guest Network'
	option portal_description 'Welcome to our guest network'
	
	# Network configuration
	option gateway '10.0.0.1'
	option netmask '255.255.252.0'
	option network '10.0.0.0/22'
	
	# Authentication settings
	option auth_timeout '3600'
	option session_timeout '7200'
	option idle_timeout '1800'
	
	# Web interface settings
	option web_root '/www-uspot'
	option template_path '/usr/share/uspot/templates'
	
	# SSL/TLS settings
	option ssl_cert '/usr/share/certs/captive.pem'
	option ssl_key '/usr/share/certs/captive.key'
	
	# Captive Portal API (RFC8908) support
	option capport_api '1'
	option capport_url 'https://captive.example.org/api'
	
	# MAC address formatting
	option format_mac 'aabbccddeeff'
	
	# Logging
	option log_level 'info'
	option log_file '/var/log/uspot.log'

# Credentials authentication mode configuration
config uspot 'credentials'
	option interface 'captive'
	option setname 'uspot'
	option mode 'credentials'
	option portal_name 'Secure Guest Network'
	option portal_description 'Please enter your credentials'
	
	# User credentials (for credentials mode)
	list user 'guest:password123'
	list user 'visitor:welcome'
	list user 'demo:demo123'
	
	# Same network and timeout settings as above
	option gateway '10.0.0.1'
	option netmask '255.255.252.0'
	option network '10.0.0.0/22'
	option auth_timeout '3600'
	option session_timeout '7200'
	option idle_timeout '1800'

# RADIUS authentication mode configuration
config uspot 'radius'
	option interface 'captive'
	option setname 'uspot'
	option mode 'radius'
	option portal_name 'RADIUS Guest Network'
	option portal_description 'Enterprise guest access'
	
	# RADIUS server settings
	option radius_server '192.168.1.100'
	option radius_port '1812'
	option radius_secret 'testing123'
	option radius_auth_port '1812'
	option radius_acct_port '1813'
	
	# RADIUS accounting
	option radius_accounting '1'
	option accounting_interval '300'
	
	# NAS (Network Access Server) identification
	option nasid 'uspot-captive-portal'
	option nasmac '00:11:22:33:44:55'
	
	# Network settings
	option gateway '10.0.0.1'
	option netmask '255.255.252.0'
	option network '10.0.0.0/22'
	option auth_timeout '3600'
	option session_timeout '7200'
	option idle_timeout '1800'

# UAM (Universal Access Method) authentication mode
config uspot 'uam'
	option interface 'captive'
	option setname 'uspot'
	option mode 'uam'
	option portal_name 'UAM Guest Network'
	option portal_description 'External authentication required'
	
	# UAM server settings
	option uam_server 'https://auth.example.com/login'
	option uam_secret 'sharedsecret123'
	option uam_port '3990'
	option uam_sslurl 'https://captive.example.org:443/'
	
	# Challenge settings
	option challenge 'randomchallenge123'
	
	# RADIUS settings for UAM
	option radius_server '192.168.1.100'
	option radius_port '1812'
	option radius_secret 'testing123'
	option radius_accounting '1'
	
	# MAC authentication bypass
	option mac_auth '1'
	list mac_bypass '11:22:33:44:55:66'
	list mac_bypass 'aa:bb:cc:dd:ee:ff'
	
	# NAS identification
	option nasid 'uspot-uam-portal'
	option nasmac '00:11:22:33:44:55'
	
	# Network settings
	option gateway '10.0.0.1'
	option netmask '255.255.252.0'
	option network '10.0.0.0/22'
	option auth_timeout '3600'
	option session_timeout '7200'
	option idle_timeout '1800'

# RADIUS Dynamic Authorization Server (DAS) configuration for RFC5176
config uspot 'das'
	option enabled '1'
	option das_port '3799'
	option das_secret 'dassecret123'
	list das_client '192.168.1.100'
	list das_client '192.168.1.101'