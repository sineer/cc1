# uspot Captive Portal DHCP Configuration
# OpenWRT 23.05+ UCI format
# Based on uspot documentation requirements

# DHCP configuration for captive portal interface
config dhcp 'captive'
	option interface 'captive'
	option start '2'
	option limit '1000'
	option leasetime '2h'
	option networkid 'captive'
	# RFC8910 Captive Portal API - DNS name is setup below
	list dhcp_option '114,https://captive.example.org/api'
	# Optionally provide NTP server (if enabled on the device) - recommended for SSL cert validation
	list dhcp_option_force '42,10.0.0.1'

# Add a local domain name for HTTPS support, name must match TLS certificate
config domain
	option name 'captive.example.org'
	option ip '10.0.0.1'

# Optional dynamic hosts whitelist using dnsmasq ipset functionality
config ipset
	list name 'wlist'
	list domain 'google.com'
	list domain 'apple.com'
	list domain 'microsoft.com'

# Additional DHCP script configuration for MAC-based authentication
config dnsmasq
	option dhcpscript '/usr/bin/uspot-dhcp-script.sh'