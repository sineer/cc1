# Secure enterprise firewall configuration
# Includes strict rules for corporate environment

config defaults
	option syn_flood '1'
	option input 'REJECT'
	option output 'ACCEPT'
	option forward 'REJECT'

config zone
	option name 'lan'
	list network 'lan'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'ACCEPT'

config zone
	option name 'guest'
	list network 'guest'
	option input 'REJECT'
	option output 'ACCEPT'
	option forward 'REJECT'

config zone
	option name 'management'
	list network 'management'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'REJECT'

config zone
	option name 'wan'
	list network 'wan'
	option input 'REJECT'
	option output 'ACCEPT'
	option forward 'REJECT'
	option masq '1'
	option mtu_fix '1'

# Allow SSH from management network
config rule
	option name 'Allow-SSH-Management'
	option src 'management'
	option proto 'tcp'
	option dest_port '22'
	option target 'ACCEPT'

# Allow HTTP/HTTPS from LAN and Guest
config rule
	option name 'Allow-HTTP-LAN'
	option src 'lan'
	option proto 'tcp'
	option dest_port '80 443'
	option target 'ACCEPT'

config rule
	option name 'Allow-HTTP-Guest'
	option src 'guest'
	option proto 'tcp'
	option dest_port '80 443'
	option target 'ACCEPT'

# Block inter-VLAN communication for guest
config rule
	option name 'Block-Guest-to-LAN'
	option src 'guest'
	option dest 'lan'
	option target 'REJECT'

config rule
	option name 'Block-Guest-to-Management'
	option src 'guest'
	option dest 'management'
	option target 'REJECT'